This code is a work in progress in terms of updating and modernizing. I'm in the process of commenting and cleaning it up.
